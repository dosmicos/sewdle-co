import { serve } from "https://deno.land/std@0.168.0/http/server.ts";
import { createClient } from "https://esm.sh/@supabase/supabase-js@2";

const corsHeaders = {
  'Access-Control-Allow-Origin': '*',
  'Access-Control-Allow-Headers': 'authorization, x-client-info, apikey, content-type',
  'Access-Control-Allow-Methods': 'GET, POST, OPTIONS',
};

// All 1,135 Colombia locations from TerriData CSV - pre-parsed
// Format: [department, municipality, dane_code (7 digits - will be padded to 8)]
const COLOMBIA_LOCATIONS: Array<[string, string, string]> = [
  // Colombia (national level - skip)
  // Antioquia
  ["Antioquia", "MedellÃ­n", "5001000"],
  ["Antioquia", "Abejorral", "5002000"],
  ["Antioquia", "AbriaquÃ­", "5004000"],
  ["Antioquia", "AlejandrÃ­a", "5021000"],
  ["Antioquia", "AmagÃ¡", "5030000"],
  ["Antioquia", "Amalfi", "5031000"],
  ["Antioquia", "Andes", "5034000"],
  ["Antioquia", "AngelÃ³polis", "5036000"],
  ["Antioquia", "Angostura", "5038000"],
  ["Antioquia", "AnorÃ­", "5040000"],
  ["Antioquia", "SantafÃ© de Antioquia", "5042000"],
  ["Antioquia", "AnzÃ¡", "5044000"],
  ["Antioquia", "ApartadÃ³", "5045000"],
  ["Antioquia", "Arboletes", "5051000"],
  ["Antioquia", "Argelia", "5055000"],
  ["Antioquia", "Armenia", "5059000"],
  ["Antioquia", "Barbosa", "5079000"],
  ["Antioquia", "Belmira", "5086000"],
  ["Antioquia", "Bello", "5088000"],
  ["Antioquia", "Betania", "5091000"],
  ["Antioquia", "Betulia", "5093000"],
  ["Antioquia", "Ciudad BolÃ­var", "5101000"],
  ["Antioquia", "BriceÃ±o", "5107000"],
  ["Antioquia", "BuriticÃ¡", "5113000"],
  ["Antioquia", "CÃ¡ceres", "5120000"],
  ["Antioquia", "Caicedo", "5125000"],
  ["Antioquia", "Caldas", "5129000"],
  ["Antioquia", "Campamento", "5134000"],
  ["Antioquia", "CaÃ±asgordas", "5138000"],
  ["Antioquia", "CaracolÃ­", "5142000"],
  ["Antioquia", "Caramanta", "5145000"],
  ["Antioquia", "Carepa", "5147000"],
  ["Antioquia", "El Carmen de Viboral", "5148000"],
  ["Antioquia", "Carolina", "5150000"],
  ["Antioquia", "Caucasia", "5154000"],
  ["Antioquia", "ChigorodÃ³", "5172000"],
  ["Antioquia", "Cisneros", "5190000"],
  ["Antioquia", "CocornÃ¡", "5197000"],
  ["Antioquia", "ConcepciÃ³n", "5206000"],
  ["Antioquia", "Concordia", "5209000"],
  ["Antioquia", "Copacabana", "5212000"],
  ["Antioquia", "Dabeiba", "5234000"],
  ["Antioquia", "Don MatÃ­as", "5237000"],
  ["Antioquia", "EbÃ©jico", "5240000"],
  ["Antioquia", "El Bagre", "5250000"],
  ["Antioquia", "Entrerrios", "5264000"],
  ["Antioquia", "Envigado", "5266000"],
  ["Antioquia", "Fredonia", "5282000"],
  ["Antioquia", "Frontino", "5284000"],
  ["Antioquia", "Giraldo", "5306000"],
  ["Antioquia", "Girardota", "5308000"],
  ["Antioquia", "GÃ³mez Plata", "5310000"],
  ["Antioquia", "Granada", "5313000"],
  ["Antioquia", "Guadalupe", "5315000"],
  ["Antioquia", "Guarne", "5318000"],
  ["Antioquia", "GuatapÃ©", "5321000"],
  ["Antioquia", "Heliconia", "5347000"],
  ["Antioquia", "Hispania", "5353000"],
  ["Antioquia", "ItagÃ¼Ã­", "5360000"],
  ["Antioquia", "Ituango", "5361000"],
  ["Antioquia", "JardÃ­n", "5364000"],
  ["Antioquia", "JericÃ³", "5368000"],
  ["Antioquia", "La Ceja", "5376000"],
  ["Antioquia", "La Estrella", "5380000"],
  ["Antioquia", "La Pintada", "5390000"],
  ["Antioquia", "La UniÃ³n", "5400000"],
  ["Antioquia", "Liborina", "5411000"],
  ["Antioquia", "Maceo", "5425000"],
  ["Antioquia", "Marinilla", "5440000"],
  ["Antioquia", "Montebello", "5467000"],
  ["Antioquia", "MurindÃ³", "5475000"],
  ["Antioquia", "MutatÃ¡", "5480000"],
  ["Antioquia", "NariÃ±o", "5483000"],
  ["Antioquia", "NecoclÃ­", "5490000"],
  ["Antioquia", "NechÃ­", "5495000"],
  ["Antioquia", "Olaya", "5501000"],
  ["Antioquia", "PeÃ±ol", "5541000"],
  ["Antioquia", "Peque", "5543000"],
  ["Antioquia", "Pueblorrico", "5576000"],
  ["Antioquia", "Puerto BerrÃ­o", "5579000"],
  ["Antioquia", "Puerto Nare", "5585000"],
  ["Antioquia", "Puerto Triunfo", "5591000"],
  ["Antioquia", "Remedios", "5604000"],
  ["Antioquia", "Retiro", "5607000"],
  ["Antioquia", "Rionegro", "5615000"],
  ["Antioquia", "Sabanalarga", "5628000"],
  ["Antioquia", "Sabaneta", "5631000"],
  ["Antioquia", "Salgar", "5642000"],
  ["Antioquia", "San AndrÃ©s de CuerquÃ­a", "5647000"],
  ["Antioquia", "San Carlos", "5649000"],
  ["Antioquia", "San Francisco", "5652000"],
  ["Antioquia", "San JerÃ³nimo", "5656000"],
  ["Antioquia", "San JosÃ© de La MontaÃ±a", "5658000"],
  ["Antioquia", "San Juan de UrabÃ¡", "5659000"],
  ["Antioquia", "San Luis", "5660000"],
  ["Antioquia", "San Pedro de Los Milagros", "5664000"],
  ["Antioquia", "San Pedro de UrabÃ¡", "5665000"],
  ["Antioquia", "San Rafael", "5667000"],
  ["Antioquia", "San Roque", "5670000"],
  ["Antioquia", "San Vicente", "5674000"],
  ["Antioquia", "Santa BÃ¡rbara", "5679000"],
  ["Antioquia", "Santa Rosa de Osos", "5686000"],
  ["Antioquia", "Santo Domingo", "5690000"],
  ["Antioquia", "El Santuario", "5697000"],
  ["Antioquia", "Segovia", "5736000"],
  ["Antioquia", "SonsÃ³n", "5756000"],
  ["Antioquia", "SopetrÃ¡n", "5761000"],
  ["Antioquia", "TÃ¡mesis", "5789000"],
  ["Antioquia", "TarazÃ¡", "5790000"],
  ["Antioquia", "Tarso", "5792000"],
  ["Antioquia", "TitiribÃ­", "5809000"],
  ["Antioquia", "Toledo", "5819000"],
  ["Antioquia", "Turbo", "5837000"],
  ["Antioquia", "Uramita", "5842000"],
  ["Antioquia", "Urrao", "5847000"],
  ["Antioquia", "Valdivia", "5854000"],
  ["Antioquia", "ValparaÃ­so", "5856000"],
  ["Antioquia", "VegachÃ­", "5858000"],
  ["Antioquia", "Venecia", "5861000"],
  ["Antioquia", "VigÃ­a del Fuerte", "5873000"],
  ["Antioquia", "YalÃ­", "5885000"],
  ["Antioquia", "Yarumal", "5887000"],
  ["Antioquia", "YolombÃ³", "5890000"],
  ["Antioquia", "YondÃ³", "5893000"],
  ["Antioquia", "Zaragoza", "5895000"],
  // AtlÃ¡ntico
  ["AtlÃ¡ntico", "Barranquilla", "8001000"],
  ["AtlÃ¡ntico", "Baranoa", "8078000"],
  ["AtlÃ¡ntico", "Campo de La Cruz", "8137000"],
  ["AtlÃ¡ntico", "Candelaria", "8141000"],
  ["AtlÃ¡ntico", "Galapa", "8296000"],
  ["AtlÃ¡ntico", "Juan de Acosta", "8372000"],
  ["AtlÃ¡ntico", "Luruaco", "8421000"],
  ["AtlÃ¡ntico", "Malambo", "8433000"],
  ["AtlÃ¡ntico", "ManatÃ­", "8436000"],
  ["AtlÃ¡ntico", "Palmar de Varela", "8520000"],
  ["AtlÃ¡ntico", "PiojÃ³", "8549000"],
  ["AtlÃ¡ntico", "Polonuevo", "8558000"],
  ["AtlÃ¡ntico", "Ponedera", "8560000"],
  ["AtlÃ¡ntico", "Puerto Colombia", "8573000"],
  ["AtlÃ¡ntico", "RepelÃ³n", "8606000"],
  ["AtlÃ¡ntico", "Sabanagrande", "8634000"],
  ["AtlÃ¡ntico", "Sabanalarga", "8638000"],
  ["AtlÃ¡ntico", "Santa LucÃ­a", "8675000"],
  ["AtlÃ¡ntico", "Santo TomÃ¡s", "8685000"],
  ["AtlÃ¡ntico", "Soledad", "8758000"],
  ["AtlÃ¡ntico", "Suan", "8770000"],
  ["AtlÃ¡ntico", "TubarÃ¡", "8832000"],
  ["AtlÃ¡ntico", "UsiacurÃ­", "8849000"],
  // BogotÃ¡
  ["BogotÃ¡", "BogotÃ¡", "11001000"],
  // BolÃ­var
  ["BolÃ­var", "Cartagena", "13001000"],
  ["BolÃ­var", "AchÃ­", "13006000"],
  ["BolÃ­var", "Altos del Rosario", "13030000"],
  ["BolÃ­var", "Arenal", "13042000"],
  ["BolÃ­var", "Arjona", "13052000"],
  ["BolÃ­var", "Arroyohondo", "13062000"],
  ["BolÃ­var", "Barranco de Loba", "13074000"],
  ["BolÃ­var", "Calamar", "13140000"],
  ["BolÃ­var", "Cantagallo", "13160000"],
  ["BolÃ­var", "Cicuco", "13188000"],
  ["BolÃ­var", "CÃ³rdoba", "13212000"],
  ["BolÃ­var", "Clemencia", "13222000"],
  ["BolÃ­var", "El Carmen de BolÃ­var", "13244000"],
  ["BolÃ­var", "El Guamo", "13248000"],
  ["BolÃ­var", "El PeÃ±Ã³n", "13268000"],
  ["BolÃ­var", "Hatillo de Loba", "13300000"],
  ["BolÃ­var", "MaganguÃ©", "13430000"],
  ["BolÃ­var", "Mahates", "13433000"],
  ["BolÃ­var", "Margarita", "13440000"],
  ["BolÃ­var", "MarÃ­a La Baja", "13442000"],
  ["BolÃ­var", "Montecristo", "13458000"],
  ["BolÃ­var", "MompÃ³s", "13468000"],
  ["BolÃ­var", "Morales", "13473000"],
  ["BolÃ­var", "NorosÃ­", "13490000"],
  ["BolÃ­var", "Pinillos", "13549000"],
  ["BolÃ­var", "Regidor", "13580000"],
  ["BolÃ­var", "RÃ­o Viejo", "13600000"],
  ["BolÃ­var", "San CristÃ³bal", "13620000"],
  ["BolÃ­var", "San Estanislao", "13647000"],
  ["BolÃ­var", "San Fernando", "13650000"],
  ["BolÃ­var", "San Jacinto", "13654000"],
  ["BolÃ­var", "San Jacinto del Cauca", "13655000"],
  ["BolÃ­var", "San Juan Nepomuceno", "13657000"],
  ["BolÃ­var", "San MartÃ­n de Loba", "13667000"],
  ["BolÃ­var", "San Pablo", "13670000"],
  ["BolÃ­var", "Santa Catalina", "13673000"],
  ["BolÃ­var", "Santa Rosa", "13683000"],
  ["BolÃ­var", "Santa Rosa del Sur", "13688000"],
  ["BolÃ­var", "SimitÃ­", "13744000"],
  ["BolÃ­var", "Soplaviento", "13760000"],
  ["BolÃ­var", "Talaigua Nuevo", "13780000"],
  ["BolÃ­var", "Tiquisio", "13810000"],
  ["BolÃ­var", "Turbaco", "13836000"],
  ["BolÃ­var", "TurbanÃ¡", "13838000"],
  ["BolÃ­var", "Villanueva", "13873000"],
  ["BolÃ­var", "Zambrano", "13894000"],
  // BoyacÃ¡
  ["BoyacÃ¡", "Tunja", "15001000"],
  ["BoyacÃ¡", "Almeida", "15022000"],
  ["BoyacÃ¡", "Aquitania", "15047000"],
  ["BoyacÃ¡", "Arcabuco", "15051000"],
  ["BoyacÃ¡", "BelÃ©n", "15087000"],
  ["BoyacÃ¡", "Berbeo", "15090000"],
  ["BoyacÃ¡", "BetÃ©itiva", "15092000"],
  ["BoyacÃ¡", "Boavita", "15097000"],
  ["BoyacÃ¡", "BoyacÃ¡", "15104000"],
  ["BoyacÃ¡", "BriceÃ±o", "15106000"],
  ["BoyacÃ¡", "Buenavista", "15109000"],
  ["BoyacÃ¡", "BusbanzÃ¡", "15114000"],
  ["BoyacÃ¡", "Caldas", "15131000"],
  ["BoyacÃ¡", "Campohermoso", "15135000"],
  ["BoyacÃ¡", "Cerinza", "15162000"],
  ["BoyacÃ¡", "Chinavita", "15172000"],
  ["BoyacÃ¡", "ChiquinquirÃ¡", "15176000"],
  ["BoyacÃ¡", "Chiscas", "15180000"],
  ["BoyacÃ¡", "Chita", "15183000"],
  ["BoyacÃ¡", "Chitaraque", "15185000"],
  ["BoyacÃ¡", "ChivatÃ¡", "15187000"],
  ["BoyacÃ¡", "CiÃ©nega", "15189000"],
  ["BoyacÃ¡", "CÃ³mbita", "15204000"],
  ["BoyacÃ¡", "Coper", "15212000"],
  ["BoyacÃ¡", "Corrales", "15215000"],
  ["BoyacÃ¡", "CovarachÃ­a", "15218000"],
  ["BoyacÃ¡", "CubarÃ¡", "15223000"],
  ["BoyacÃ¡", "Cucaita", "15224000"],
  ["BoyacÃ¡", "CuÃ­tiva", "15226000"],
  ["BoyacÃ¡", "ChÃ­quiza", "15232000"],
  ["BoyacÃ¡", "Chivor", "15236000"],
  ["BoyacÃ¡", "Duitama", "15238000"],
  ["BoyacÃ¡", "El Cocuy", "15244000"],
  ["BoyacÃ¡", "El Espino", "15248000"],
  ["BoyacÃ¡", "Firavitoba", "15272000"],
  ["BoyacÃ¡", "Floresta", "15276000"],
  ["BoyacÃ¡", "GachantivÃ¡", "15293000"],
  ["BoyacÃ¡", "GÃ¡meza", "15296000"],
  ["BoyacÃ¡", "Garagoa", "15299000"],
  ["BoyacÃ¡", "Guacamayas", "15317000"],
  ["BoyacÃ¡", "Guateque", "15322000"],
  ["BoyacÃ¡", "GuayatÃ¡", "15325000"],
  ["BoyacÃ¡", "GÃ¼icÃ¡n", "15332000"],
  ["BoyacÃ¡", "Iza", "15362000"],
  ["BoyacÃ¡", "Jenesano", "15367000"],
  ["BoyacÃ¡", "JericÃ³", "15368000"],
  ["BoyacÃ¡", "Labranzagrande", "15377000"],
  ["BoyacÃ¡", "La Capilla", "15380000"],
  ["BoyacÃ¡", "La Victoria", "15401000"],
  ["BoyacÃ¡", "La Uvita", "15403000"],
  ["BoyacÃ¡", "Villa de Leyva", "15407000"],
  ["BoyacÃ¡", "Macanal", "15425000"],
  ["BoyacÃ¡", "MaripÃ­", "15442000"],
  ["BoyacÃ¡", "Miraflores", "15455000"],
  ["BoyacÃ¡", "Mongua", "15464000"],
  ["BoyacÃ¡", "MonguÃ­", "15466000"],
  ["BoyacÃ¡", "MoniquirÃ¡", "15469000"],
  ["BoyacÃ¡", "Motavita", "15476000"],
  ["BoyacÃ¡", "Muzo", "15480000"],
  ["BoyacÃ¡", "Nobsa", "15491000"],
  ["BoyacÃ¡", "Nuevo ColÃ³n", "15494000"],
  ["BoyacÃ¡", "OicatÃ¡", "15500000"],
  ["BoyacÃ¡", "Otanche", "15507000"],
  ["BoyacÃ¡", "Pachavita", "15511000"],
  ["BoyacÃ¡", "PÃ¡ez", "15514000"],
  ["BoyacÃ¡", "Paipa", "15516000"],
  ["BoyacÃ¡", "Pajarito", "15518000"],
  ["BoyacÃ¡", "Panqueba", "15522000"],
  ["BoyacÃ¡", "Pauna", "15531000"],
  ["BoyacÃ¡", "Paya", "15533000"],
  ["BoyacÃ¡", "Paz de RÃ­o", "15537000"],
  ["BoyacÃ¡", "Pesca", "15542000"],
  ["BoyacÃ¡", "Pisba", "15550000"],
  ["BoyacÃ¡", "Puerto BoyacÃ¡", "15572000"],
  ["BoyacÃ¡", "QuÃ­pama", "15580000"],
  ["BoyacÃ¡", "RamiriquÃ­", "15599000"],
  ["BoyacÃ¡", "RÃ¡quira", "15600000"],
  ["BoyacÃ¡", "RondÃ³n", "15621000"],
  ["BoyacÃ¡", "SaboyÃ¡", "15632000"],
  ["BoyacÃ¡", "SÃ¡chica", "15638000"],
  ["BoyacÃ¡", "SamacÃ¡", "15646000"],
  ["BoyacÃ¡", "San Eduardo", "15660000"],
  ["BoyacÃ¡", "San JosÃ© de Pare", "15664000"],
  ["BoyacÃ¡", "San Luis de Gaceno", "15667000"],
  ["BoyacÃ¡", "San Mateo", "15673000"],
  ["BoyacÃ¡", "San Miguel de Sema", "15676000"],
  ["BoyacÃ¡", "San Pablo de Borbur", "15681000"],
  ["BoyacÃ¡", "Santana", "15686000"],
  ["BoyacÃ¡", "Santa MarÃ­a", "15690000"],
  ["BoyacÃ¡", "Santa Rosa de Viterbo", "15693000"],
  ["BoyacÃ¡", "Santa SofÃ­a", "15696000"],
  ["BoyacÃ¡", "Sativanorte", "15720000"],
  ["BoyacÃ¡", "Sativasur", "15723000"],
  ["BoyacÃ¡", "Siachoque", "15740000"],
  ["BoyacÃ¡", "SoatÃ¡", "15753000"],
  ["BoyacÃ¡", "SocotÃ¡", "15755000"],
  ["BoyacÃ¡", "Socha", "15757000"],
  ["BoyacÃ¡", "Sogamoso", "15759000"],
  ["BoyacÃ¡", "Somondoco", "15761000"],
  ["BoyacÃ¡", "Sora", "15762000"],
  ["BoyacÃ¡", "SotaquirÃ¡", "15763000"],
  ["BoyacÃ¡", "SoracÃ¡", "15764000"],
  ["BoyacÃ¡", "SusacÃ³n", "15774000"],
  ["BoyacÃ¡", "SutamarchÃ¡n", "15776000"],
  ["BoyacÃ¡", "Sutatenza", "15778000"],
  ["BoyacÃ¡", "Tasco", "15790000"],
  ["BoyacÃ¡", "Tenza", "15798000"],
  ["BoyacÃ¡", "TibanÃ¡", "15804000"],
  ["BoyacÃ¡", "Tibasosa", "15806000"],
  ["BoyacÃ¡", "TinjacÃ¡", "15808000"],
  ["BoyacÃ¡", "Tipacoque", "15810000"],
  ["BoyacÃ¡", "Toca", "15814000"],
  ["BoyacÃ¡", "TogÃ¼Ã­", "15816000"],
  ["BoyacÃ¡", "TÃ³paga", "15820000"],
  ["BoyacÃ¡", "Tota", "15822000"],
  ["BoyacÃ¡", "TununguÃ¡", "15832000"],
  ["BoyacÃ¡", "TurmequÃ©", "15835000"],
  ["BoyacÃ¡", "Tuta", "15837000"],
  ["BoyacÃ¡", "TutazÃ¡", "15839000"],
  ["BoyacÃ¡", "Umbita", "15842000"],
  ["BoyacÃ¡", "Ventaquemada", "15861000"],
  ["BoyacÃ¡", "ViracachÃ¡", "15879000"],
  ["BoyacÃ¡", "Zetaquira", "15897000"],
  // Caldas
  ["Caldas", "Manizales", "17001000"],
  ["Caldas", "Aguadas", "17013000"],
  ["Caldas", "Anserma", "17042000"],
  ["Caldas", "Aranzazu", "17050000"],
  ["Caldas", "BelalcÃ¡zar", "17088000"],
  ["Caldas", "ChinchinÃ¡", "17174000"],
  ["Caldas", "Filadelfia", "17272000"],
  ["Caldas", "La Dorada", "17380000"],
  ["Caldas", "La Merced", "17388000"],
  ["Caldas", "Manzanares", "17433000"],
  ["Caldas", "Marmato", "17442000"],
  ["Caldas", "Marquetalia", "17444000"],
  ["Caldas", "Marulanda", "17446000"],
  ["Caldas", "Neira", "17486000"],
  ["Caldas", "Norcasia", "17495000"],
  ["Caldas", "PÃ¡cora", "17513000"],
  ["Caldas", "Palestina", "17524000"],
  ["Caldas", "Pensilvania", "17541000"],
  ["Caldas", "Riosucio", "17614000"],
  ["Caldas", "Risaralda", "17616000"],
  ["Caldas", "Salamina", "17653000"],
  ["Caldas", "SamanÃ¡", "17662000"],
  ["Caldas", "San JosÃ©", "17665000"],
  ["Caldas", "SupÃ­a", "17777000"],
  ["Caldas", "Victoria", "17867000"],
  ["Caldas", "VillamarÃ­a", "17873000"],
  ["Caldas", "Viterbo", "17877000"],
  // CaquetÃ¡
  ["CaquetÃ¡", "Florencia", "18001000"],
  ["CaquetÃ¡", "Albania", "18029000"],
  ["CaquetÃ¡", "BelÃ©n de Los AndaquÃ­es", "18094000"],
  ["CaquetÃ¡", "Cartagena del ChairÃ¡", "18150000"],
  ["CaquetÃ¡", "Curillo", "18205000"],
  ["CaquetÃ¡", "El Doncello", "18247000"],
  ["CaquetÃ¡", "El Paujil", "18256000"],
  ["CaquetÃ¡", "La MontaÃ±ita", "18410000"],
  ["CaquetÃ¡", "MilÃ¡n", "18460000"],
  ["CaquetÃ¡", "Morelia", "18479000"],
  ["CaquetÃ¡", "Puerto Rico", "18592000"],
  ["CaquetÃ¡", "San JosÃ© del Fragua", "18610000"],
  ["CaquetÃ¡", "San Vicente del CaguÃ¡n", "18753000"],
  ["CaquetÃ¡", "Solano", "18756000"],
  ["CaquetÃ¡", "Solita", "18785000"],
  ["CaquetÃ¡", "ValparaÃ­so", "18860000"],
  // Cauca
  ["Cauca", "PopayÃ¡n", "19001000"],
  ["Cauca", "Almaguer", "19022000"],
  ["Cauca", "Argelia", "19050000"],
  ["Cauca", "Balboa", "19075000"],
  ["Cauca", "BolÃ­var", "19100000"],
  ["Cauca", "Buenos Aires", "19110000"],
  ["Cauca", "CajibÃ­o", "19130000"],
  ["Cauca", "Caldono", "19137000"],
  ["Cauca", "Caloto", "19142000"],
  ["Cauca", "Corinto", "19212000"],
  ["Cauca", "El Tambo", "19256000"],
  ["Cauca", "Florencia", "19290000"],
  ["Cauca", "GuachenÃ©", "19300000"],
  ["Cauca", "Guapi", "19318000"],
  ["Cauca", "InzÃ¡", "19355000"],
  ["Cauca", "JambalÃ³", "19364000"],
  ["Cauca", "La Sierra", "19392000"],
  ["Cauca", "La Vega", "19397000"],
  ["Cauca", "LÃ³pez", "19418000"],
  ["Cauca", "Mercaderes", "19450000"],
  ["Cauca", "Miranda", "19455000"],
  ["Cauca", "Morales", "19473000"],
  ["Cauca", "Padilla", "19513000"],
  ["Cauca", "PaÃ©z", "19517000"],
  ["Cauca", "PatÃ­a", "19532000"],
  ["Cauca", "Piamonte", "19533000"],
  ["Cauca", "PiendamÃ³", "19548000"],
  ["Cauca", "Puerto Tejada", "19573000"],
  ["Cauca", "PuracÃ©", "19585000"],
  ["Cauca", "Rosas", "19622000"],
  ["Cauca", "San SebastiÃ¡n", "19693000"],
  ["Cauca", "Santander de Quilichao", "19698000"],
  ["Cauca", "Santa Rosa", "19701000"],
  ["Cauca", "Silvia", "19743000"],
  ["Cauca", "SotarÃ¡", "19760000"],
  ["Cauca", "SuÃ¡rez", "19780000"],
  ["Cauca", "Sucre", "19785000"],
  ["Cauca", "TimbÃ­o", "19807000"],
  ["Cauca", "TimbiquÃ­", "19809000"],
  ["Cauca", "ToribÃ­o", "19821000"],
  ["Cauca", "TotorÃ³", "19824000"],
  ["Cauca", "Villa Rica", "19845000"],
  // Cesar
  ["Cesar", "Valledupar", "20001000"],
  ["Cesar", "Aguachica", "20011000"],
  ["Cesar", "AgustÃ­n Codazzi", "20013000"],
  ["Cesar", "Astrea", "20032000"],
  ["Cesar", "Becerril", "20045000"],
  ["Cesar", "Bosconia", "20060000"],
  ["Cesar", "Chimichagua", "20175000"],
  ["Cesar", "ChiriguanÃ¡", "20178000"],
  ["Cesar", "CurumanÃ­", "20228000"],
  ["Cesar", "El Copey", "20238000"],
  ["Cesar", "El Paso", "20250000"],
  ["Cesar", "Gamarra", "20295000"],
  ["Cesar", "GonzÃ¡lez", "20310000"],
  ["Cesar", "La Gloria", "20383000"],
  ["Cesar", "La Jagua de Ibirico", "20400000"],
  ["Cesar", "Manaure", "20443000"],
  ["Cesar", "Pailitas", "20517000"],
  ["Cesar", "Pelaya", "20550000"],
  ["Cesar", "Pueblo Bello", "20570000"],
  ["Cesar", "RÃ­o de Oro", "20614000"],
  ["Cesar", "La Paz", "20621000"],
  ["Cesar", "San Alberto", "20710000"],
  ["Cesar", "San Diego", "20750000"],
  ["Cesar", "San MartÃ­n", "20770000"],
  ["Cesar", "Tamalameque", "20787000"],
  // CÃ³rdoba
  ["CÃ³rdoba", "MonterÃ­a", "23001000"],
  ["CÃ³rdoba", "Ayapel", "23068000"],
  ["CÃ³rdoba", "Buenavista", "23079000"],
  ["CÃ³rdoba", "Canalete", "23090000"],
  ["CÃ³rdoba", "CeretÃ©", "23162000"],
  ["CÃ³rdoba", "ChimÃ¡", "23168000"],
  ["CÃ³rdoba", "ChinÃº", "23182000"],
  ["CÃ³rdoba", "CiÃ©naga de Oro", "23189000"],
  ["CÃ³rdoba", "Cotorra", "23300000"],
  ["CÃ³rdoba", "La Apartada", "23350000"],
  ["CÃ³rdoba", "Lorica", "23417000"],
  ["CÃ³rdoba", "Los CÃ³rdobas", "23419000"],
  ["CÃ³rdoba", "Momil", "23464000"],
  ["CÃ³rdoba", "MontelÃ­bano", "23466000"],
  ["CÃ³rdoba", "MoÃ±itos", "23500000"],
  ["CÃ³rdoba", "Planeta Rica", "23555000"],
  ["CÃ³rdoba", "Pueblo Nuevo", "23570000"],
  ["CÃ³rdoba", "Puerto Escondido", "23574000"],
  ["CÃ³rdoba", "Puerto Libertador", "23580000"],
  ["CÃ³rdoba", "PurÃ­sima", "23586000"],
  ["CÃ³rdoba", "SahagÃºn", "23660000"],
  ["CÃ³rdoba", "San AndrÃ©s Sotavento", "23670000"],
  ["CÃ³rdoba", "San Antero", "23672000"],
  ["CÃ³rdoba", "San Bernardo del Viento", "23675000"],
  ["CÃ³rdoba", "San Carlos", "23678000"],
  ["CÃ³rdoba", "San JosÃ© de Ure", "23682000"],
  ["CÃ³rdoba", "San Pelayo", "23686000"],
  ["CÃ³rdoba", "Tierralta", "23807000"],
  ["CÃ³rdoba", "TuchÃ­n", "23815000"],
  ["CÃ³rdoba", "Valencia", "23855000"],
  // Cundinamarca
  ["Cundinamarca", "Agua de Dios", "25001000"],
  ["Cundinamarca", "AlbÃ¡n", "25019000"],
  ["Cundinamarca", "Anapoima", "25035000"],
  ["Cundinamarca", "Anolaima", "25040000"],
  ["Cundinamarca", "ArbelÃ¡ez", "25053000"],
  ["Cundinamarca", "BeltrÃ¡n", "25086000"],
  ["Cundinamarca", "Bituima", "25095000"],
  ["Cundinamarca", "BojacÃ¡", "25099000"],
  ["Cundinamarca", "Cabrera", "25120000"],
  ["Cundinamarca", "Cachipay", "25123000"],
  ["Cundinamarca", "CajicÃ¡", "25126000"],
  ["Cundinamarca", "CaparrapÃ­", "25148000"],
  ["Cundinamarca", "CÃ¡queza", "25151000"],
  ["Cundinamarca", "Carmen de Carupa", "25154000"],
  ["Cundinamarca", "ChaguanÃ­", "25168000"],
  ["Cundinamarca", "ChÃ­a", "25175000"],
  ["Cundinamarca", "Chipaque", "25178000"],
  ["Cundinamarca", "ChoachÃ­", "25181000"],
  ["Cundinamarca", "ChocontÃ¡", "25183000"],
  ["Cundinamarca", "Cogua", "25200000"],
  ["Cundinamarca", "Cota", "25214000"],
  ["Cundinamarca", "CucunubÃ¡", "25224000"],
  ["Cundinamarca", "El Colegio", "25245000"],
  ["Cundinamarca", "El PeÃ±Ã³n", "25258000"],
  ["Cundinamarca", "El Rosal", "25260000"],
  ["Cundinamarca", "FacatativÃ¡", "25269000"],
  ["Cundinamarca", "FÃ³meque", "25279000"],
  ["Cundinamarca", "Fosca", "25281000"],
  ["Cundinamarca", "Funza", "25286000"],
  ["Cundinamarca", "FÃºquene", "25288000"],
  ["Cundinamarca", "FusagasugÃ¡", "25290000"],
  ["Cundinamarca", "GachalÃ¡", "25293000"],
  ["Cundinamarca", "GachancipÃ¡", "25295000"],
  ["Cundinamarca", "GachetÃ¡", "25297000"],
  ["Cundinamarca", "Gama", "25299000"],
  ["Cundinamarca", "Girardot", "25307000"],
  ["Cundinamarca", "Granada", "25312000"],
  ["Cundinamarca", "GuachetÃ¡", "25317000"],
  ["Cundinamarca", "Guaduas", "25320000"],
  ["Cundinamarca", "Guasca", "25322000"],
  ["Cundinamarca", "GuataquÃ­", "25324000"],
  ["Cundinamarca", "Guatavita", "25326000"],
  ["Cundinamarca", "Guayabal de SÃ­quima", "25328000"],
  ["Cundinamarca", "Guayabetal", "25335000"],
  ["Cundinamarca", "GutiÃ©rrez", "25339000"],
  ["Cundinamarca", "JerusalÃ©n", "25368000"],
  ["Cundinamarca", "JunÃ­n", "25372000"],
  ["Cundinamarca", "La Calera", "25377000"],
  ["Cundinamarca", "La Mesa", "25386000"],
  ["Cundinamarca", "La Palma", "25394000"],
  ["Cundinamarca", "La PeÃ±a", "25398000"],
  ["Cundinamarca", "La Vega", "25402000"],
  ["Cundinamarca", "Lenguazaque", "25407000"],
  ["Cundinamarca", "MachetÃ¡", "25426000"],
  ["Cundinamarca", "Madrid", "25430000"],
  ["Cundinamarca", "Manta", "25436000"],
  ["Cundinamarca", "Medina", "25438000"],
  ["Cundinamarca", "Mosquera", "25473000"],
  ["Cundinamarca", "NariÃ±o", "25483000"],
  ["Cundinamarca", "NemocÃ³n", "25486000"],
  ["Cundinamarca", "Nilo", "25488000"],
  ["Cundinamarca", "Nimaima", "25489000"],
  ["Cundinamarca", "Nocaima", "25491000"],
  ["Cundinamarca", "Venecia", "25506000"],
  ["Cundinamarca", "Pacho", "25513000"],
  ["Cundinamarca", "Paime", "25518000"],
  ["Cundinamarca", "Pandi", "25524000"],
  ["Cundinamarca", "Paratebueno", "25530000"],
  ["Cundinamarca", "Pasca", "25535000"],
  ["Cundinamarca", "Puerto Salgar", "25572000"],
  ["Cundinamarca", "PulÃ­", "25580000"],
  ["Cundinamarca", "Quebradanegra", "25592000"],
  ["Cundinamarca", "Quetame", "25594000"],
  ["Cundinamarca", "Quipile", "25596000"],
  ["Cundinamarca", "Apulo", "25599000"],
  ["Cundinamarca", "Ricaurte", "25612000"],
  ["Cundinamarca", "San Antonio del Tequendama", "25645000"],
  ["Cundinamarca", "San Bernardo", "25649000"],
  ["Cundinamarca", "San Cayetano", "25653000"],
  ["Cundinamarca", "San Francisco", "25658000"],
  ["Cundinamarca", "San Juan de RÃ­o Seco", "25662000"],
  ["Cundinamarca", "Sasaima", "25718000"],
  ["Cundinamarca", "SesquilÃ©", "25736000"],
  ["Cundinamarca", "SibatÃ©", "25740000"],
  ["Cundinamarca", "Silvania", "25743000"],
  ["Cundinamarca", "Simijaca", "25745000"],
  ["Cundinamarca", "Soacha", "25754000"],
  ["Cundinamarca", "SopÃ³", "25758000"],
  ["Cundinamarca", "Subachoque", "25769000"],
  ["Cundinamarca", "Suesca", "25772000"],
  ["Cundinamarca", "SupatÃ¡", "25777000"],
  ["Cundinamarca", "Susa", "25779000"],
  ["Cundinamarca", "Sutatausa", "25781000"],
  ["Cundinamarca", "Tabio", "25785000"],
  ["Cundinamarca", "Tausa", "25793000"],
  ["Cundinamarca", "Tena", "25797000"],
  ["Cundinamarca", "Tenjo", "25799000"],
  ["Cundinamarca", "Tibacuy", "25805000"],
  ["Cundinamarca", "Tibirita", "25807000"],
  ["Cundinamarca", "Tocaima", "25815000"],
  ["Cundinamarca", "TocancipÃ¡", "25817000"],
  ["Cundinamarca", "TopaipÃ­", "25823000"],
  ["Cundinamarca", "UbalÃ¡", "25839000"],
  ["Cundinamarca", "Ubaque", "25841000"],
  ["Cundinamarca", "Villa de San Diego de Ubate", "25843000"],
  ["Cundinamarca", "Une", "25845000"],
  ["Cundinamarca", "Ãštica", "25851000"],
  ["Cundinamarca", "Vergara", "25862000"],
  ["Cundinamarca", "VianÃ­", "25867000"],
  ["Cundinamarca", "VillagÃ³mez", "25871000"],
  ["Cundinamarca", "VillapinzÃ³n", "25873000"],
  ["Cundinamarca", "Villeta", "25875000"],
  ["Cundinamarca", "ViotÃ¡", "25878000"],
  ["Cundinamarca", "YacopÃ­", "25885000"],
  ["Cundinamarca", "ZipacÃ³n", "25898000"],
  ["Cundinamarca", "ZipaquirÃ¡", "25899000"],
  // ChocÃ³
  ["ChocÃ³", "QuibdÃ³", "27001000"],
  ["ChocÃ³", "AcandÃ­", "27006000"],
  ["ChocÃ³", "Alto BaudÃ³", "27025000"],
  ["ChocÃ³", "Atrato", "27050000"],
  ["ChocÃ³", "BagadÃ³", "27073000"],
  ["ChocÃ³", "BahÃ­a Solano", "27075000"],
  ["ChocÃ³", "Bajo BaudÃ³", "27077000"],
  ["ChocÃ³", "BojayÃ¡", "27099000"],
  ["ChocÃ³", "El CantÃ³n del San Pablo", "27135000"],
  ["ChocÃ³", "Carmen del DariÃ©n", "27150000"],
  ["ChocÃ³", "CÃ©rtegui", "27160000"],
  ["ChocÃ³", "Condoto", "27205000"],
  ["ChocÃ³", "El Carmen de Atrato", "27245000"],
  ["ChocÃ³", "El Litoral del San Juan", "27250000"],
  ["ChocÃ³", "Istmina", "27361000"],
  ["ChocÃ³", "JuradÃ³", "27372000"],
  ["ChocÃ³", "LlorÃ³", "27413000"],
  ["ChocÃ³", "Medio Atrato", "27425000"],
  ["ChocÃ³", "Medio BaudÃ³", "27430000"],
  ["ChocÃ³", "Medio San Juan", "27450000"],
  ["ChocÃ³", "NÃ³vita", "27491000"],
  ["ChocÃ³", "NuquÃ­", "27495000"],
  ["ChocÃ³", "RÃ­o IrÃ³", "27580000"],
  ["ChocÃ³", "RÃ­o Quito", "27600000"],
  ["ChocÃ³", "Riosucio", "27615000"],
  ["ChocÃ³", "San JosÃ© del Palmar", "27660000"],
  ["ChocÃ³", "SipÃ­", "27745000"],
  ["ChocÃ³", "TadÃ³", "27787000"],
  ["ChocÃ³", "UnguÃ­a", "27800000"],
  ["ChocÃ³", "UniÃ³n Panamericana", "27810000"],
  // Huila
  ["Huila", "Neiva", "41001000"],
  ["Huila", "Acevedo", "41006000"],
  ["Huila", "Agrado", "41013000"],
  ["Huila", "Aipe", "41016000"],
  ["Huila", "Algeciras", "41020000"],
  ["Huila", "Altamira", "41026000"],
  ["Huila", "Baraya", "41078000"],
  ["Huila", "Campoalegre", "41132000"],
  ["Huila", "Colombia", "41206000"],
  ["Huila", "ElÃ­as", "41244000"],
  ["Huila", "GarzÃ³n", "41298000"],
  ["Huila", "Gigante", "41306000"],
  ["Huila", "Guadalupe", "41319000"],
  ["Huila", "Hobo", "41349000"],
  ["Huila", "Iquira", "41357000"],
  ["Huila", "Isnos", "41359000"],
  ["Huila", "La Argentina", "41378000"],
  ["Huila", "La Plata", "41396000"],
  ["Huila", "NÃ¡taga", "41483000"],
  ["Huila", "Oporapa", "41503000"],
  ["Huila", "Paicol", "41518000"],
  ["Huila", "Palermo", "41524000"],
  ["Huila", "Palestina", "41530000"],
  ["Huila", "Pital", "41548000"],
  ["Huila", "Pitalito", "41551000"],
  ["Huila", "Rivera", "41615000"],
  ["Huila", "Saladoblanco", "41660000"],
  ["Huila", "San AgustÃ­n", "41668000"],
  ["Huila", "Santa MarÃ­a", "41676000"],
  ["Huila", "Suaza", "41770000"],
  ["Huila", "Tarqui", "41791000"],
  ["Huila", "Tesalia", "41797000"],
  ["Huila", "Tello", "41799000"],
  ["Huila", "Teruel", "41801000"],
  ["Huila", "TimanÃ¡", "41807000"],
  ["Huila", "Villavieja", "41872000"],
  ["Huila", "YaguarÃ¡", "41885000"],
  // La Guajira
  ["La Guajira", "Riohacha", "44001000"],
  ["La Guajira", "Albania", "44035000"],
  ["La Guajira", "Barrancas", "44078000"],
  ["La Guajira", "Dibulla", "44090000"],
  ["La Guajira", "DistracciÃ³n", "44098000"],
  ["La Guajira", "El Molino", "44110000"],
  ["La Guajira", "Fonseca", "44279000"],
  ["La Guajira", "Hatonuevo", "44378000"],
  ["La Guajira", "La Jagua del Pilar", "44420000"],
  ["La Guajira", "Maicao", "44430000"],
  ["La Guajira", "Manaure", "44560000"],
  ["La Guajira", "San Juan del Cesar", "44650000"],
  ["La Guajira", "Uribia", "44847000"],
  ["La Guajira", "Urumita", "44855000"],
  ["La Guajira", "Villanueva", "44874000"],
  // Magdalena
  ["Magdalena", "Santa Marta", "47001000"],
  ["Magdalena", "Algarrobo", "47030000"],
  ["Magdalena", "Aracataca", "47053000"],
  ["Magdalena", "AriguanÃ­", "47058000"],
  ["Magdalena", "Cerro San Antonio", "47161000"],
  ["Magdalena", "Chibolo", "47170000"],
  ["Magdalena", "CiÃ©naga", "47189000"],
  ["Magdalena", "Concordia", "47205000"],
  ["Magdalena", "El Banco", "47245000"],
  ["Magdalena", "El PiÃ±Ã³n", "47258000"],
  ["Magdalena", "El RetÃ©n", "47268000"],
  ["Magdalena", "FundaciÃ³n", "47288000"],
  ["Magdalena", "Guamal", "47318000"],
  ["Magdalena", "Nueva Granada", "47460000"],
  ["Magdalena", "Pedraza", "47541000"],
  ["Magdalena", "PijiÃ±o del Carmen", "47545000"],
  ["Magdalena", "Pivijay", "47551000"],
  ["Magdalena", "Plato", "47555000"],
  ["Magdalena", "Puebloviejo", "47570000"],
  ["Magdalena", "Remolino", "47605000"],
  ["Magdalena", "Sabanas de San Ãngel", "47660000"],
  ["Magdalena", "Salamina", "47675000"],
  ["Magdalena", "San SebastiÃ¡n de Buenavista", "47692000"],
  ["Magdalena", "San ZenÃ³n", "47703000"],
  ["Magdalena", "Santa Ana", "47707000"],
  ["Magdalena", "Santa BÃ¡rbara de Pinto", "47720000"],
  ["Magdalena", "Sitionuevo", "47745000"],
  ["Magdalena", "Tenerife", "47798000"],
  ["Magdalena", "ZapayÃ¡n", "47960000"],
  ["Magdalena", "Zona Bananera", "47980000"],
  // Meta
  ["Meta", "Villavicencio", "50001000"],
  ["Meta", "AcacÃ­as", "50006000"],
  ["Meta", "Barranca de UpÃ­a", "50110000"],
  ["Meta", "Cabuyaro", "50124000"],
  ["Meta", "Castilla La Nueva", "50150000"],
  ["Meta", "Cubarral", "50223000"],
  ["Meta", "Cumaral", "50226000"],
  ["Meta", "El Calvario", "50245000"],
  ["Meta", "El Castillo", "50251000"],
  ["Meta", "El Dorado", "50270000"],
  ["Meta", "Fuente de Oro", "50287000"],
  ["Meta", "Granada", "50313000"],
  ["Meta", "Guamal", "50318000"],
  ["Meta", "MapiripÃ¡n", "50325000"],
  ["Meta", "Mesetas", "50330000"],
  ["Meta", "La Macarena", "50350000"],
  ["Meta", "Uribe", "50370000"],
  ["Meta", "LejanÃ­as", "50400000"],
  ["Meta", "Puerto Concordia", "50450000"],
  ["Meta", "Puerto GaitÃ¡n", "50568000"],
  ["Meta", "Puerto LÃ³pez", "50573000"],
  ["Meta", "Puerto Lleras", "50577000"],
  ["Meta", "Puerto Rico", "50590000"],
  ["Meta", "Restrepo", "50606000"],
  ["Meta", "San Carlos de Guaroa", "50680000"],
  ["Meta", "San Juan de Arama", "50683000"],
  ["Meta", "San Juanito", "50686000"],
  ["Meta", "San MartÃ­n", "50689000"],
  ["Meta", "Vistahermosa", "50711000"],
  // NariÃ±o
  ["NariÃ±o", "Pasto", "52001000"],
  ["NariÃ±o", "AlbÃ¡n", "52019000"],
  ["NariÃ±o", "Aldana", "52022000"],
  ["NariÃ±o", "AncuyÃ¡", "52036000"],
  ["NariÃ±o", "Arboleda", "52051000"],
  ["NariÃ±o", "Barbacoas", "52079000"],
  ["NariÃ±o", "BelÃ©n", "52083000"],
  ["NariÃ±o", "Buesaco", "52110000"],
  ["NariÃ±o", "ColÃ³n", "52203000"],
  ["NariÃ±o", "ConsacÃ¡", "52207000"],
  ["NariÃ±o", "Contadero", "52210000"],
  ["NariÃ±o", "CÃ³rdoba", "52215000"],
  ["NariÃ±o", "Cuaspud", "52224000"],
  ["NariÃ±o", "Cumbal", "52227000"],
  ["NariÃ±o", "Cumbitara", "52233000"],
  ["NariÃ±o", "ChachagÃ¼Ã­", "52240000"],
  ["NariÃ±o", "El Charco", "52250000"],
  ["NariÃ±o", "El PeÃ±ol", "52254000"],
  ["NariÃ±o", "El Rosario", "52256000"],
  ["NariÃ±o", "El TablÃ³n de GÃ³mez", "52258000"],
  ["NariÃ±o", "El Tambo", "52260000"],
  ["NariÃ±o", "Funes", "52287000"],
  ["NariÃ±o", "Guachucal", "52317000"],
  ["NariÃ±o", "Guaitarilla", "52320000"],
  ["NariÃ±o", "GualmatÃ¡n", "52323000"],
  ["NariÃ±o", "Iles", "52352000"],
  ["NariÃ±o", "ImuÃ©s", "52354000"],
  ["NariÃ±o", "Ipiales", "52356000"],
  ["NariÃ±o", "La Cruz", "52378000"],
  ["NariÃ±o", "La Florida", "52381000"],
  ["NariÃ±o", "La Llanada", "52385000"],
  ["NariÃ±o", "La Tola", "52390000"],
  ["NariÃ±o", "La UniÃ³n", "52399000"],
  ["NariÃ±o", "Leiva", "52405000"],
  ["NariÃ±o", "Linares", "52411000"],
  ["NariÃ±o", "Los Andes", "52418000"],
  ["NariÃ±o", "MagÃ¼i", "52427000"],
  ["NariÃ±o", "Mallama", "52435000"],
  ["NariÃ±o", "Mosquera", "52473000"],
  ["NariÃ±o", "NariÃ±o", "52480000"],
  ["NariÃ±o", "Olaya Herrera", "52490000"],
  ["NariÃ±o", "Ospina", "52506000"],
  ["NariÃ±o", "Francisco Pizarro", "52520000"],
  ["NariÃ±o", "Policarpa", "52540000"],
  ["NariÃ±o", "PotosÃ­", "52560000"],
  ["NariÃ±o", "Providencia", "52565000"],
  ["NariÃ±o", "Puerres", "52573000"],
  ["NariÃ±o", "Pupiales", "52585000"],
  ["NariÃ±o", "Ricaurte", "52612000"],
  ["NariÃ±o", "Roberto PayÃ¡n", "52621000"],
  ["NariÃ±o", "Samaniego", "52678000"],
  ["NariÃ±o", "SandonÃ¡", "52683000"],
  ["NariÃ±o", "San Bernardo", "52685000"],
  ["NariÃ±o", "San Lorenzo", "52687000"],
  ["NariÃ±o", "San Pablo", "52693000"],
  ["NariÃ±o", "San Pedro de Cartago", "52694000"],
  ["NariÃ±o", "Santa BÃ¡rbara", "52696000"],
  ["NariÃ±o", "Santacruz", "52699000"],
  ["NariÃ±o", "Sapuyes", "52720000"],
  ["NariÃ±o", "Taminango", "52786000"],
  ["NariÃ±o", "Tangua", "52788000"],
  ["NariÃ±o", "San AndrÃ©s de Tumaco", "52835000"],
  ["NariÃ±o", "TÃºquerres", "52838000"],
  ["NariÃ±o", "Yacuanquer", "52885000"],
  // Norte de Santander
  ["Norte de Santander", "CÃºcuta", "54001000"],
  ["Norte de Santander", "Ãbrego", "54003000"],
  ["Norte de Santander", "Arboledas", "54051000"],
  ["Norte de Santander", "Bochalema", "54099000"],
  ["Norte de Santander", "Bucarasica", "54109000"],
  ["Norte de Santander", "CÃ¡cota", "54125000"],
  ["Norte de Santander", "CachirÃ¡", "54128000"],
  ["Norte de Santander", "ChinÃ¡cota", "54172000"],
  ["Norte de Santander", "ChitagÃ¡", "54174000"],
  ["Norte de Santander", "ConvenciÃ³n", "54206000"],
  ["Norte de Santander", "Cucutilla", "54223000"],
  ["Norte de Santander", "Durania", "54239000"],
  ["Norte de Santander", "El Carmen", "54245000"],
  ["Norte de Santander", "El Tarra", "54250000"],
  ["Norte de Santander", "El Zulia", "54261000"],
  ["Norte de Santander", "Gramalote", "54313000"],
  ["Norte de Santander", "HacarÃ­", "54344000"],
  ["Norte de Santander", "HerrÃ¡n", "54347000"],
  ["Norte de Santander", "Labateca", "54377000"],
  ["Norte de Santander", "La Esperanza", "54385000"],
  ["Norte de Santander", "La Playa", "54398000"],
  ["Norte de Santander", "Los Patios", "54405000"],
  ["Norte de Santander", "Lourdes", "54418000"],
  ["Norte de Santander", "Mutiscua", "54480000"],
  ["Norte de Santander", "OcaÃ±a", "54498000"],
  ["Norte de Santander", "Pamplona", "54518000"],
  ["Norte de Santander", "Pamplonita", "54520000"],
  ["Norte de Santander", "Puerto Santander", "54553000"],
  ["Norte de Santander", "Ragonvalia", "54599000"],
  ["Norte de Santander", "Salazar", "54660000"],
  ["Norte de Santander", "San Calixto", "54670000"],
  ["Norte de Santander", "San Cayetano", "54673000"],
  ["Norte de Santander", "Santiago", "54680000"],
  ["Norte de Santander", "Sardinata", "54720000"],
  ["Norte de Santander", "Silos", "54743000"],
  ["Norte de Santander", "Teorama", "54800000"],
  ["Norte de Santander", "TibÃº", "54810000"],
  ["Norte de Santander", "Toledo", "54820000"],
  ["Norte de Santander", "Villa Caro", "54871000"],
  ["Norte de Santander", "Villa del Rosario", "54874000"],
  // QuindÃ­o
  ["QuindÃ­o", "Armenia", "63001000"],
  ["QuindÃ­o", "Buenavista", "63111000"],
  ["QuindÃ­o", "CalarcÃ¡", "63130000"],
  ["QuindÃ­o", "Circasia", "63190000"],
  ["QuindÃ­o", "CÃ³rdoba", "63212000"],
  ["QuindÃ­o", "Filandia", "63272000"],
  ["QuindÃ­o", "GÃ©nova", "63302000"],
  ["QuindÃ­o", "La Tebaida", "63401000"],
  ["QuindÃ­o", "Montenegro", "63470000"],
  ["QuindÃ­o", "Pijao", "63548000"],
  ["QuindÃ­o", "Quimbaya", "63594000"],
  ["QuindÃ­o", "Salento", "63690000"],
  // Risaralda
  ["Risaralda", "Pereira", "66001000"],
  ["Risaralda", "ApÃ­a", "66045000"],
  ["Risaralda", "Balboa", "66075000"],
  ["Risaralda", "BelÃ©n de UmbrÃ­a", "66088000"],
  ["Risaralda", "Dosquebradas", "66170000"],
  ["Risaralda", "GuÃ¡tica", "66318000"],
  ["Risaralda", "La Celia", "66383000"],
  ["Risaralda", "La Virginia", "66400000"],
  ["Risaralda", "Marsella", "66440000"],
  ["Risaralda", "MistratÃ³", "66456000"],
  ["Risaralda", "Pueblo Rico", "66572000"],
  ["Risaralda", "QuinchÃ­a", "66594000"],
  ["Risaralda", "Santa Rosa de Cabal", "66682000"],
  ["Risaralda", "Santuario", "66687000"],
  // Santander
  ["Santander", "Bucaramanga", "68001000"],
  ["Santander", "Aguada", "68013000"],
  ["Santander", "Albania", "68020000"],
  ["Santander", "Aratoca", "68051000"],
  ["Santander", "Barbosa", "68077000"],
  ["Santander", "Barichara", "68079000"],
  ["Santander", "Barrancabermeja", "68081000"],
  ["Santander", "Betulia", "68092000"],
  ["Santander", "BolÃ­var", "68101000"],
  ["Santander", "Cabrera", "68121000"],
  ["Santander", "California", "68132000"],
  ["Santander", "Capitanejo", "68147000"],
  ["Santander", "CarcasÃ­", "68152000"],
  ["Santander", "CepitÃ¡", "68160000"],
  ["Santander", "Cerrito", "68162000"],
  ["Santander", "CharalÃ¡", "68167000"],
  ["Santander", "Charta", "68169000"],
  ["Santander", "Chima", "68176000"],
  ["Santander", "ChipatÃ¡", "68179000"],
  ["Santander", "Cimitarra", "68190000"],
  ["Santander", "ConcepciÃ³n", "68207000"],
  ["Santander", "Confines", "68209000"],
  ["Santander", "ContrataciÃ³n", "68211000"],
  ["Santander", "Coromoro", "68217000"],
  ["Santander", "CuritÃ­", "68229000"],
  ["Santander", "El Carmen de ChucurÃ­", "68235000"],
  ["Santander", "El Guacamayo", "68245000"],
  ["Santander", "El PeÃ±Ã³n", "68250000"],
  ["Santander", "El PlayÃ³n", "68255000"],
  ["Santander", "Encino", "68264000"],
  ["Santander", "Enciso", "68266000"],
  ["Santander", "FloriÃ¡n", "68271000"],
  ["Santander", "Floridablanca", "68276000"],
  ["Santander", "GalÃ¡n", "68296000"],
  ["Santander", "GÃ¡mbita", "68298000"],
  ["Santander", "GirÃ³n", "68307000"],
  ["Santander", "Guaca", "68318000"],
  ["Santander", "Guadalupe", "68320000"],
  ["Santander", "GuapotÃ¡", "68322000"],
  ["Santander", "GuavatÃ¡", "68324000"],
  ["Santander", "GÃ¼epsa", "68327000"],
  ["Santander", "Hato", "68344000"],
  ["Santander", "JesÃºs MarÃ­a", "68368000"],
  ["Santander", "JordÃ¡n", "68370000"],
  ["Santander", "La Belleza", "68377000"],
  ["Santander", "LandÃ¡zuri", "68385000"],
  ["Santander", "La Paz", "68397000"],
  ["Santander", "Lebrija", "68406000"],
  ["Santander", "Los Santos", "68418000"],
  ["Santander", "Macaravita", "68425000"],
  ["Santander", "MÃ¡laga", "68432000"],
  ["Santander", "Matanza", "68444000"],
  ["Santander", "Mogotes", "68464000"],
  ["Santander", "Molagavita", "68468000"],
  ["Santander", "Ocamonte", "68498000"],
  ["Santander", "Oiba", "68500000"],
  ["Santander", "Onzaga", "68502000"],
  ["Santander", "Palmar", "68522000"],
  ["Santander", "Palmas del Socorro", "68524000"],
  ["Santander", "PÃ¡ramo", "68533000"],
  ["Santander", "Piedecuesta", "68547000"],
  ["Santander", "Pinchote", "68549000"],
  ["Santander", "Puente Nacional", "68572000"],
  ["Santander", "Puerto Parra", "68573000"],
  ["Santander", "Puerto Wilches", "68575000"],
  ["Santander", "Rionegro", "68615000"],
  ["Santander", "Sabana de Torres", "68655000"],
  ["Santander", "San AndrÃ©s", "68669000"],
  ["Santander", "San Benito", "68673000"],
  ["Santander", "San Gil", "68679000"],
  ["Santander", "San JoaquÃ­n", "68682000"],
  ["Santander", "San JosÃ© de Miranda", "68684000"],
  ["Santander", "San Miguel", "68686000"],
  ["Santander", "San Vicente de ChucurÃ­", "68689000"],
  ["Santander", "Santa BÃ¡rbara", "68705000"],
  ["Santander", "Santa Helena del OpÃ³n", "68720000"],
  ["Santander", "Simacota", "68745000"],
  ["Santander", "Socorro", "68755000"],
  ["Santander", "Suaita", "68770000"],
  ["Santander", "Sucre", "68773000"],
  ["Santander", "SuratÃ¡", "68780000"],
  ["Santander", "Tona", "68820000"],
  ["Santander", "Valle de San JosÃ©", "68855000"],
  ["Santander", "VÃ©lez", "68861000"],
  ["Santander", "Vetas", "68867000"],
  ["Santander", "Villanueva", "68872000"],
  ["Santander", "Zapatoca", "68895000"],
  // Sucre
  ["Sucre", "Sincelejo", "70001000"],
  ["Sucre", "Buenavista", "70110000"],
  ["Sucre", "Caimito", "70124000"],
  ["Sucre", "ColosÃ³", "70204000"],
  ["Sucre", "Corozal", "70215000"],
  ["Sucre", "CoveÃ±as", "70221000"],
  ["Sucre", "ChalÃ¡n", "70230000"],
  ["Sucre", "El Roble", "70233000"],
  ["Sucre", "Galeras", "70235000"],
  ["Sucre", "Guaranda", "70265000"],
  ["Sucre", "La UniÃ³n", "70400000"],
  ["Sucre", "Los Palmitos", "70418000"],
  ["Sucre", "Majagual", "70429000"],
  ["Sucre", "Morroa", "70473000"],
  ["Sucre", "Ovejas", "70508000"],
  ["Sucre", "Palmito", "70523000"],
  ["Sucre", "SampuÃ©s", "70670000"],
  ["Sucre", "San Benito Abad", "70678000"],
  ["Sucre", "San Juan de Betulia", "70702000"],
  ["Sucre", "San Marcos", "70708000"],
  ["Sucre", "San Onofre", "70713000"],
  ["Sucre", "San Pedro", "70717000"],
  ["Sucre", "San Luis de SincÃ©", "70742000"],
  ["Sucre", "Sucre", "70771000"],
  ["Sucre", "Santiago de TolÃº", "70820000"],
  ["Sucre", "TolÃº Viejo", "70823000"],
  // Tolima
  ["Tolima", "IbaguÃ©", "73001000"],
  ["Tolima", "Alpujarra", "73024000"],
  ["Tolima", "Alvarado", "73026000"],
  ["Tolima", "Ambalema", "73030000"],
  ["Tolima", "AnzoÃ¡tegui", "73043000"],
  ["Tolima", "Armero", "73055000"],
  ["Tolima", "Ataco", "73067000"],
  ["Tolima", "Cajamarca", "73124000"],
  ["Tolima", "Carmen de ApicalÃ¡", "73148000"],
  ["Tolima", "Casabianca", "73152000"],
  ["Tolima", "Chaparral", "73168000"],
  ["Tolima", "Coello", "73200000"],
  ["Tolima", "Coyaima", "73217000"],
  ["Tolima", "Cunday", "73226000"],
  ["Tolima", "Dolores", "73236000"],
  ["Tolima", "Espinal", "73268000"],
  ["Tolima", "Falan", "73270000"],
  ["Tolima", "Flandes", "73275000"],
  ["Tolima", "Fresno", "73283000"],
  ["Tolima", "Guamo", "73319000"],
  ["Tolima", "Herveo", "73347000"],
  ["Tolima", "Honda", "73349000"],
  ["Tolima", "Icononzo", "73352000"],
  ["Tolima", "LÃ©rida", "73408000"],
  ["Tolima", "LÃ­bano", "73411000"],
  ["Tolima", "San SebastiÃ¡n de Mariquita", "73443000"],
  ["Tolima", "Melgar", "73449000"],
  ["Tolima", "Murillo", "73461000"],
  ["Tolima", "Natagaima", "73483000"],
  ["Tolima", "Ortega", "73504000"],
  ["Tolima", "Palocabildo", "73520000"],
  ["Tolima", "Piedras", "73547000"],
  ["Tolima", "Planadas", "73555000"],
  ["Tolima", "Prado", "73563000"],
  ["Tolima", "PurificaciÃ³n", "73585000"],
  ["Tolima", "Rioblanco", "73616000"],
  ["Tolima", "Roncesvalles", "73622000"],
  ["Tolima", "Rovira", "73624000"],
  ["Tolima", "SaldaÃ±a", "73671000"],
  ["Tolima", "San Antonio", "73675000"],
  ["Tolima", "San Luis", "73678000"],
  ["Tolima", "Santa Isabel", "73686000"],
  ["Tolima", "SuÃ¡rez", "73770000"],
  ["Tolima", "Valle de San Juan", "73854000"],
  ["Tolima", "Venadillo", "73861000"],
  ["Tolima", "Villahermosa", "73870000"],
  ["Tolima", "Villarrica", "73873000"],
  // Valle del Cauca
  ["Valle del Cauca", "Cali", "76001000"],
  ["Valle del Cauca", "AlcalÃ¡", "76020000"],
  ["Valle del Cauca", "AndalucÃ­a", "76036000"],
  ["Valle del Cauca", "Ansermanuevo", "76041000"],
  ["Valle del Cauca", "Argelia", "76054000"],
  ["Valle del Cauca", "BolÃ­var", "76100000"],
  ["Valle del Cauca", "Buenaventura", "76109000"],
  ["Valle del Cauca", "Guadalajara de Buga", "76111000"],
  ["Valle del Cauca", "Bugalagrande", "76113000"],
  ["Valle del Cauca", "Caicedonia", "76122000"],
  ["Valle del Cauca", "Calima", "76126000"],
  ["Valle del Cauca", "Candelaria", "76130000"],
  ["Valle del Cauca", "Cartago", "76147000"],
  ["Valle del Cauca", "Dagua", "76233000"],
  ["Valle del Cauca", "El Ãguila", "76243000"],
  ["Valle del Cauca", "El Cairo", "76246000"],
  ["Valle del Cauca", "El Cerrito", "76248000"],
  ["Valle del Cauca", "El Dovio", "76250000"],
  ["Valle del Cauca", "Florida", "76275000"],
  ["Valle del Cauca", "Ginebra", "76306000"],
  ["Valle del Cauca", "GuacarÃ­", "76318000"],
  ["Valle del Cauca", "JamundÃ­", "76364000"],
  ["Valle del Cauca", "La Cumbre", "76377000"],
  ["Valle del Cauca", "La UniÃ³n", "76400000"],
  ["Valle del Cauca", "La Victoria", "76403000"],
  ["Valle del Cauca", "Obando", "76497000"],
  ["Valle del Cauca", "Palmira", "76520000"],
  ["Valle del Cauca", "Pradera", "76563000"],
  ["Valle del Cauca", "Restrepo", "76606000"],
  ["Valle del Cauca", "RiofrÃ­o", "76616000"],
  ["Valle del Cauca", "Roldanillo", "76622000"],
  ["Valle del Cauca", "San Pedro", "76670000"],
  ["Valle del Cauca", "Sevilla", "76736000"],
  ["Valle del Cauca", "Toro", "76823000"],
  ["Valle del Cauca", "Trujillo", "76828000"],
  ["Valle del Cauca", "TuluÃ¡", "76834000"],
  ["Valle del Cauca", "Ulloa", "76845000"],
  ["Valle del Cauca", "Versalles", "76863000"],
  ["Valle del Cauca", "Vijes", "76869000"],
  ["Valle del Cauca", "Yotoco", "76890000"],
  ["Valle del Cauca", "Yumbo", "76892000"],
  ["Valle del Cauca", "Zarzal", "76895000"],
  // Arauca
  ["Arauca", "Arauca", "81001000"],
  ["Arauca", "Arauquita", "81065000"],
  ["Arauca", "Cravo Norte", "81220000"],
  ["Arauca", "Fortul", "81300000"],
  ["Arauca", "Puerto RondÃ³n", "81591000"],
  ["Arauca", "Saravena", "81736000"],
  ["Arauca", "Tame", "81794000"],
  // Casanare
  ["Casanare", "Yopal", "85001000"],
  ["Casanare", "Aguazul", "85010000"],
  ["Casanare", "ChÃ¡meza", "85015000"],
  ["Casanare", "Hato Corozal", "85125000"],
  ["Casanare", "La Salina", "85136000"],
  ["Casanare", "ManÃ­", "85139000"],
  ["Casanare", "Monterrey", "85162000"],
  ["Casanare", "NunchÃ­a", "85225000"],
  ["Casanare", "OrocuÃ©", "85230000"],
  ["Casanare", "Paz de Ariporo", "85250000"],
  ["Casanare", "Pore", "85263000"],
  ["Casanare", "Recetor", "85279000"],
  ["Casanare", "Sabanalarga", "85300000"],
  ["Casanare", "SÃ¡cama", "85315000"],
  ["Casanare", "San Luis de Palenque", "85325000"],
  ["Casanare", "TÃ¡mara", "85400000"],
  ["Casanare", "Tauramena", "85410000"],
  ["Casanare", "Trinidad", "85430000"],
  ["Casanare", "Villanueva", "85440000"],
  // Putumayo
  ["Putumayo", "Mocoa", "86001000"],
  ["Putumayo", "ColÃ³n", "86219000"],
  ["Putumayo", "Orito", "86320000"],
  ["Putumayo", "Puerto AsÃ­s", "86568000"],
  ["Putumayo", "Puerto Caicedo", "86569000"],
  ["Putumayo", "Puerto GuzmÃ¡n", "86571000"],
  ["Putumayo", "Puerto LeguÃ­zamo", "86573000"],
  ["Putumayo", "Sibundoy", "86749000"],
  ["Putumayo", "San Francisco", "86755000"],
  ["Putumayo", "San Miguel", "86757000"],
  ["Putumayo", "Santiago", "86760000"],
  ["Putumayo", "Valle del Guamuez", "86865000"],
  ["Putumayo", "VillagarzÃ³n", "86885000"],
  // San AndrÃ©s y Providencia
  ["San AndrÃ©s y Providencia", "Providencia", "88564000"],
  // Amazonas
  ["Amazonas", "Leticia", "91001000"],
  ["Amazonas", "Puerto NariÃ±o", "91540000"],
  // GuainÃ­a
  ["GuainÃ­a", "InÃ­rida", "94001000"],
  ["GuainÃ­a", "Barrancominas", "94343000"],
  // Guaviare
  ["Guaviare", "San JosÃ© del Guaviare", "95001000"],
  ["Guaviare", "Calamar", "95015000"],
  ["Guaviare", "El Retorno", "95025000"],
  ["Guaviare", "Miraflores", "95200000"],
  // VaupÃ©s
  ["VaupÃ©s", "MitÃº", "97001000"],
  ["VaupÃ©s", "CarurÃº", "97161000"],
  ["VaupÃ©s", "Taraira", "97666000"],
  // Vichada
  ["Vichada", "Puerto CarreÃ±o", "99001000"],
  ["Vichada", "La Primavera", "99524000"],
  ["Vichada", "Santa RosalÃ­a", "99624000"],
  ["Vichada", "Cumaribo", "99773000"],
];

// Major cities with Deprisa coverage
const MAJOR_CITIES = [
  'bogotÃ¡', 'medellÃ­n', 'cali', 'barranquilla', 'cartagena', 
  'bucaramanga', 'cÃºcuta', 'pereira', 'manizales', 'ibaguÃ©',
  'santa marta', 'monterÃ­a', 'neiva', 'pasto', 'villavicencio',
  'armenia', 'popayÃ¡n', 'sincelejo', 'valledupar', 'tunja'
];

// Format DANE code to 8 digits (add leading 0)
function formatDaneCode(code: string): string {
  // If code is 7 digits, add leading 0
  if (code.length === 7) {
    return '0' + code;
  }
  return code;
}

// Check if city has Deprisa coverage
function hasDeprisaCoverage(municipality: string): boolean {
  const normalizedMunicipality = municipality.toLowerCase()
    .normalize('NFD').replace(/[\u0300-\u036f]/g, '');
  
  return MAJOR_CITIES.some(city => {
    const normalizedCity = city.normalize('NFD').replace(/[\u0300-\u036f]/g, '');
    return normalizedMunicipality.includes(normalizedCity) || normalizedCity.includes(normalizedMunicipality);
  });
}

serve(async (req) => {
  if (req.method === 'OPTIONS') {
    return new Response(null, { headers: corsHeaders });
  }

  try {
    const supabaseUrl = Deno.env.get('SUPABASE_URL')!;
    const supabaseKey = Deno.env.get('SUPABASE_SERVICE_ROLE_KEY')!;
    const supabase = createClient(supabaseUrl, supabaseKey);

    // Get the Dosmicos organization ID
    const { data: org, error: orgError } = await supabase
      .from('organizations')
      .select('id')
      .eq('slug', 'dosmicos-org')
      .single();

    if (orgError || !org) {
      console.error('âŒ Could not find dosmicos-org:', orgError);
      return new Response(
        JSON.stringify({ success: false, error: 'OrganizaciÃ³n dosmicos-org no encontrada' }),
        { headers: { ...corsHeaders, 'Content-Type': 'application/json' }, status: 404 }
      );
    }

    const organizationId = org.id;
    console.log(`âœ… Found organization dosmicos-org with ID: ${organizationId}`);

    // Clear existing data for this organization
    const { error: deleteError } = await supabase
      .from('shipping_coverage')
      .delete()
      .eq('organization_id', organizationId);

    if (deleteError) {
      console.error('âš ï¸ Error clearing existing data:', deleteError);
    }

    // Prepare records for insertion
    const records = COLOMBIA_LOCATIONS.map(([department, municipality, daneCode]) => ({
      organization_id: organizationId,
      department,
      municipality,
      dane_code: formatDaneCode(daneCode),
      coordinadora: true, // National coverage
      interrapidisimo: true, // National coverage
      deprisa: hasDeprisaCoverage(municipality),
      priority_carrier: 'coordinadora'
    }));

    console.log(`ðŸ“¦ Preparing to insert ${records.length} location records...`);

    // Insert in batches of 100
    const BATCH_SIZE = 100;
    let inserted = 0;
    let errors = 0;

    for (let i = 0; i < records.length; i += BATCH_SIZE) {
      const batch = records.slice(i, i + BATCH_SIZE);
      
      const { error: insertError } = await supabase
        .from('shipping_coverage')
        .insert(batch);

      if (insertError) {
        console.error(`âŒ Error inserting batch ${i / BATCH_SIZE + 1}:`, insertError);
        errors++;
      } else {
        inserted += batch.length;
        console.log(`âœ… Inserted batch ${Math.floor(i / BATCH_SIZE) + 1}: ${batch.length} records (total: ${inserted})`);
      }
    }

    console.log(`\nðŸ“Š Import Summary:`);
    console.log(`   - Total records: ${records.length}`);
    console.log(`   - Inserted: ${inserted}`);
    console.log(`   - Batches with errors: ${errors}`);

    return new Response(
      JSON.stringify({
        success: true,
        message: `ImportaciÃ³n completada: ${inserted} ubicaciones insertadas`,
        total_records: records.length,
        inserted,
        errors
      }),
      { headers: { ...corsHeaders, 'Content-Type': 'application/json' } }
    );

  } catch (error: unknown) {
    console.error('âŒ Import error:', error);
    return new Response(
      JSON.stringify({ success: false, error: error.message }),
      { headers: { ...corsHeaders, 'Content-Type': 'application/json' }, status: 500 }
    );
  }
});
